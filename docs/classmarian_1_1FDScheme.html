<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.11"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>Marian: marian::FDScheme Class Reference</title>
        <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="marian.css" rel="stylesheet" type="text/css"/>
<link href="bootstrap_custom.css" rel="stylesheet" type="text/css"/>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootswatch/3.3.1/flatly/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="doxy-boot.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">Marian 0.9</a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main</span></a></li>
      <li><a href="pages.html"><span>Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>marian</b></li><li class="navelem"><a class="el" href="classmarian_1_1FDScheme.html">FDScheme</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classmarian_1_1FDScheme-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">marian::FDScheme Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span><div class="ingroups"><a class="el" href="group__fdm.html">Finite Difference Method</a> &raquo; <a class="el" href="group__schemes.html">Differentiating schemes</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Class implements interface for differential schemes.  
 <a href="classmarian_1_1FDScheme.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="fdScheme_8hpp_source.html">fdScheme.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for marian::FDScheme:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classmarian_1_1FDScheme.png" usemap="#marian::FDScheme_map" alt=""/>
  <map id="marian::FDScheme_map" name="marian::FDScheme_map">
<area href="classmarian_1_1DCFDScheme.html" alt="marian::DCFDScheme&lt; CrankNicolsonScheme &gt;" shape="rect" coords="0,56,288,80"/>
<area href="classmarian_1_1DCFDScheme.html" alt="marian::DCFDScheme&lt; ExplicitScheme &gt;" shape="rect" coords="298,56,586,80"/>
<area href="classmarian_1_1DCFDScheme.html" alt="marian::DCFDScheme&lt; ImplicitScheme &gt;" shape="rect" coords="596,56,884,80"/>
<area href="classmarian_1_1DCFDScheme.html" title="Deeply copyable BoundaryCondition. " alt="marian::DCFDScheme&lt; T &gt;" shape="rect" coords="894,56,1182,80"/>
<area href="classmarian_1_1CrankNicolsonScheme.html" title="Class implements Crank-Nicolson Scheme. " alt="marian::CrankNicolsonScheme" shape="rect" coords="0,112,288,136"/>
<area href="classmarian_1_1ExplicitScheme.html" title="Class implements implicit schemes. " alt="marian::ExplicitScheme" shape="rect" coords="298,112,586,136"/>
<area href="classmarian_1_1ImplicitScheme.html" title="Class implements implicit schemes. " alt="marian::ImplicitScheme" shape="rect" coords="596,112,884,136"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aba41775b5f8bb9e1741b206d5b4a637c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aba41775b5f8bb9e1741b206d5b4a637c"></a>
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarian_1_1FDScheme.html#aba41775b5f8bb9e1741b206d5b4a637c">setSolver</a> (const <a class="el" href="classmarian_1_1SmartPointer.html">SmartPointer</a>&lt; <a class="el" href="classmarian_1_1TridiagonalSolver.html">TridiagonalSolver</a> &gt; &amp;solver)=0</td></tr>
<tr class="memdesc:aba41775b5f8bb9e1741b206d5b4a637c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provides a solver used in implicit scheme. <br /></td></tr>
<tr class="separator:aba41775b5f8bb9e1741b206d5b4a637c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d25d551ebb736b017c0c08654c4b39d"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarian_1_1FDScheme.html#a1d25d551ebb736b017c0c08654c4b39d">solve</a> (std::vector&lt; double &gt; f, const std::vector&lt; <a class="el" href="classmarian_1_1SmartPointer.html">SmartPointer</a>&lt; <a class="el" href="classmarian_1_1BoundaryCondition.html">BoundaryCondition</a> &gt; &gt; &amp;bcs, const std::vector&lt; double &gt; &amp;time_grid, const <a class="el" href="classmarian_1_1TridiagonalOperator.html">TridiagonalOperator</a> &amp;L)=0</td></tr>
<tr class="memdesc:a1d25d551ebb736b017c0c08654c4b39d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves PDE defined by provided linear operator <b>L</b> and initial and boundary conditions.  <a href="#a1d25d551ebb736b017c0c08654c4b39d">More...</a><br /></td></tr>
<tr class="separator:a1d25d551ebb736b017c0c08654c4b39d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3948cc50afc4f2f73dc2c5a0537817f5"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarian_1_1FDScheme.html#a3948cc50afc4f2f73dc2c5a0537817f5">solveAndSave</a> (std::vector&lt; double &gt; f, const std::vector&lt; <a class="el" href="classmarian_1_1SmartPointer.html">SmartPointer</a>&lt; <a class="el" href="classmarian_1_1BoundaryCondition.html">BoundaryCondition</a> &gt; &gt; &amp;bcs, const std::vector&lt; double &gt; &amp;spatial_grid, const std::vector&lt; double &gt; &amp;time_grid, const <a class="el" href="classmarian_1_1TridiagonalOperator.html">TridiagonalOperator</a> &amp;L, const std::string file_name)=0</td></tr>
<tr class="memdesc:a3948cc50afc4f2f73dc2c5a0537817f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves PDE defined by provided linear operator <b>L</b> and initial and boundary conditions. Additionally saves solution to CSV file.  <a href="#a3948cc50afc4f2f73dc2c5a0537817f5">More...</a><br /></td></tr>
<tr class="separator:a3948cc50afc4f2f73dc2c5a0537817f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addbcc5aeea98560087e46c2838c5a883"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="addbcc5aeea98560087e46c2838c5a883"></a>
virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarian_1_1FDScheme.html#addbcc5aeea98560087e46c2838c5a883">info</a> () const  =0</td></tr>
<tr class="memdesc:addbcc5aeea98560087e46c2838c5a883"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns scheme name. <br /></td></tr>
<tr class="separator:addbcc5aeea98560087e46c2838c5a883"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ea50cb5328fbb913a17344b914aa8df"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4ea50cb5328fbb913a17344b914aa8df"></a>
virtual <a class="el" href="classmarian_1_1FDScheme.html">FDScheme</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarian_1_1FDScheme.html#a4ea50cb5328fbb913a17344b914aa8df">clone</a> () const  =0</td></tr>
<tr class="memdesc:a4ea50cb5328fbb913a17344b914aa8df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual copy constructor. <br /></td></tr>
<tr class="separator:a4ea50cb5328fbb913a17344b914aa8df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ec0902e05520ffaf7ec8e20eccf3444"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8ec0902e05520ffaf7ec8e20eccf3444"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarian_1_1FDScheme.html#a8ec0902e05520ffaf7ec8e20eccf3444">~FDScheme</a> ()</td></tr>
<tr class="memdesc:a8ec0902e05520ffaf7ec8e20eccf3444"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deconstructor. <br /></td></tr>
<tr class="separator:a8ec0902e05520ffaf7ec8e20eccf3444"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>When we solve following parabolic PDE: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[\frac{df(x,t)}{dt} = L f(x,t)\]" src="form_20.png"/>
</p>
<p> where <b>L</b> is linear operator, we can use different time discretization scheme, for example in case of Forward Kolmogorov Equation: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{aligned} \text{in case of explicit scheme: }\frac{f(x_i,t_{j+1})-f(x_i,t_{j})}{t_{j+1}-t_{j}} &amp; = \hat{L} f(x_i,t_{j}) \Rightarrow f(x_i,t_{j+1})= (I + (t_{j+1}-t_{j})\hat{L}) f(x_i,t_{j}) \\ \text{in case of explicit scheme: }\frac{f(x_i,t_{j+1})-f(x_i,t_{j})}{t_{j+1}-t_{j}} &amp; = \hat{L} f(x_i,t_{j+1}) \Rightarrow f(x_i,t_{j})= (I - (t_{j+1}-t_{j})\hat{L}) f(x_i,t_{j+1}) \end{aligned} \]" src="form_22.png"/>
</p>
<p>The difference between implicit scheme and explicit scheme lies in number of unknown values of on the time level. In explicit scheme we have three known values (in case of forward equation): <img class="formulaInl" alt="$f(x_{i-1},t_{i}),f(x_{i},t_{i}),f(x_{i+1},t_{i})$" src="form_23.png"/> and one unknown <img class="formulaInl" alt="$f(x_{i},t_{i+1})$" src="form_24.png"/>. This is why we can explicitly find the unknown values. In case of implicit we have three unknown values and one known for each time point. Solving this kind of system requires finding global solution. Because of that implicit scheme is numerically more demanding, but it is unconditionally stable in contrast to explicit scheme. For more information see <a class="el" href="citelist.html#CITEREF_DuffyFDM">[2]</a> <a class="el" href="citelist.html#CITEREF_ClarkFx">[5]</a> <a class="el" href="citelist.html#CITEREF_MortonMayers">[10]</a> . </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a1d25d551ebb736b017c0c08654c4b39d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::vector&lt;double&gt; marian::FDScheme::solve </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classmarian_1_1SmartPointer.html">SmartPointer</a>&lt; <a class="el" href="classmarian_1_1BoundaryCondition.html">BoundaryCondition</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>bcs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>time_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classmarian_1_1TridiagonalOperator.html">TridiagonalOperator</a> &amp;&#160;</td>
          <td class="paramname"><em>L</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>Initial condition </td></tr>
    <tr><td class="paramname">bcs</td><td>Boundary conditions </td></tr>
    <tr><td class="paramname">time_grid</td><td>Time grid used in </td></tr>
    <tr><td class="paramname">L</td><td>Linear operator defining PDE </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Solution in form of std::vector </dd></dl>

<p>Implemented in <a class="el" href="classmarian_1_1ExplicitScheme.html#a5002a52a7bc10b8fad8a195c651b5297">marian::ExplicitScheme</a>, <a class="el" href="classmarian_1_1ImplicitScheme.html#aa8dc8af9eec1271d6127175695d19991">marian::ImplicitScheme</a>, and <a class="el" href="classmarian_1_1CrankNicolsonScheme.html#a49424d3ffc6e192aab15163717babf0d">marian::CrankNicolsonScheme</a>.</p>

</div>
</div>
<a class="anchor" id="a3948cc50afc4f2f73dc2c5a0537817f5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::vector&lt;double&gt; marian::FDScheme::solveAndSave </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classmarian_1_1SmartPointer.html">SmartPointer</a>&lt; <a class="el" href="classmarian_1_1BoundaryCondition.html">BoundaryCondition</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>bcs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>spatial_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>time_grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classmarian_1_1TridiagonalOperator.html">TridiagonalOperator</a> &amp;&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>file_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>Initial condition </td></tr>
    <tr><td class="paramname">bcs</td><td>Boundary conditions </td></tr>
    <tr><td class="paramname">spatial_grid</td><td>Spatial grid corresponding to initial conditions (used only to save the solution to CSV file) </td></tr>
    <tr><td class="paramname">time_grid</td><td>Time grid used for time dimension of FDM </td></tr>
    <tr><td class="paramname">L</td><td>Linear operator defining PDE </td></tr>
    <tr><td class="paramname">file_name</td><td>Name of CSV file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Solution in form of std::vector </dd></dl>

<p>Implemented in <a class="el" href="classmarian_1_1ExplicitScheme.html#a28879aec11eded5ecc166949ab59aa6b">marian::ExplicitScheme</a>, <a class="el" href="classmarian_1_1ImplicitScheme.html#a6ef82f432d21eb9cf76a6a9139250d5b">marian::ImplicitScheme</a>, and <a class="el" href="classmarian_1_1CrankNicolsonScheme.html#a5f73e0dc83a3a24009205705744e3f5d">marian::CrankNicolsonScheme</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>C:/Unix/home/OEM/fdm/src/FDM/schemes/<a class="el" href="fdScheme_8hpp_source.html">fdScheme.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
